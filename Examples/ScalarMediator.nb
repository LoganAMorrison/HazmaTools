(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48808,       1256]
NotebookOptionsPosition[     43629,       1168]
NotebookOutlinePosition[     43982,       1184]
CellTagsIndexPosition[     43939,       1181]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.781997139311057*^9, 3.7819971406885653`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3fcc87be-0fb9-46a3-a845-283a91adacdf"],

Cell[CellGroupData[{

Cell["MeV-DM: Scalar Mediator model", "Title",
 CellChangeTimes->{{3.781907253965453*^9, 
  3.781907266121696*^9}},ExpressionUUID->"86471f5c-9740-4661-9e72-\
77c1a8ac5e9e"],

Cell["\<\
Load `HazmaTools`.Note that this will load `FeynCalc` and the patched \
`FeynArts`\
\>", "Text",
 CellChangeTimes->{{3.781996703343504*^9, 
  3.7819967103452*^9}},ExpressionUUID->"25aa9fe5-b3d3-4d71-9dff-7f7212d567a0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "HazmaTools`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HazmaModel", "=", "\"\<scalar\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.7819878394673653`*^9, 3.7819878570274773`*^9}, {
   3.781988170060143*^9, 3.781988170269985*^9}, {3.7819883184168253`*^9, 
   3.781988318926458*^9}, 3.781996576189617*^9, {3.781996611779121*^9, 
   3.7819966234760427`*^9}, {3.781996672270649*^9, 3.781996674160694*^9}, {
   3.781996713527828*^9, 3.7819967149935093`*^9}, {3.781997612993465*^9, 
   3.7819976596618567`*^9}, {3.781997994508951*^9, 3.781998072385819*^9}, 
   3.782814748121532*^9, {3.7828147846183558`*^9, 3.782814788750143*^9}, {
   3.782814887002653*^9, 3.782814887881711*^9}, {3.7828167288850527`*^9, 
   3.782816729285716*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"7d60b1b7-c18a-409d-91c6-218296c1be36"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynCalc \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"9.2.0. For help, use the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"documentation", " ", "center"}],
       BaseStyle->"Link",
       ButtonData:>"paclet:FeynCalc/",
       ButtonNote->"paclet:FeynCalc/"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\", check out the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["wiki",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://github.com/FeynCalc/feyncalc/wiki"], None},
       ButtonNote->"https://github.com/FeynCalc/feyncalc/wiki"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or write to the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"mailing", " ", 
        RowBox[{"list", "."}]}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feyncalc.org/forum/"], None},
       ButtonNote->"http://www.feyncalc.org/forum/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynCalc ", "Text", Bold], 
    Style["9.2.0. For help, use the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "documentation center", BaseStyle -> "Link", ButtonData :> 
       "paclet:FeynCalc/", ButtonNote -> "paclet:FeynCalc/"]], "Text"], 
    Style[", check out the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["wiki", ButtonData :> {
         URL["https://github.com/FeynCalc/feyncalc/wiki"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc/wiki"]], "Text"], 
    Style[" or write to the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["mailing list.", ButtonData :> {
         URL["http://www.feyncalc.org/forum/"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "http://www.feyncalc.org/forum/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.783077167429449*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"30301dd5-0c5c-4056-bb78-4e1d00b2ca04"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"See also the supplied \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"examples", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" If you use FeynCalc in your research, please cite\"\>", 
     "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["See also the supplied ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]], Evaluator -> 
       Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" If you use FeynCalc in your research, please cite", "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.783077167440612*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"8993b10a-9230-4a5e-ae35-1c1d43be25f3"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] V. Shtabovenko, R. Mertig and F. Orellana, Comput. \
Phys. Commun., 207C, 432-444, 2016, arXiv:1601.01167\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.783077167447483*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"fe5a2286-72ee-4d39-9b49-f42b10050213"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] R. Mertig, M. B\[ODoubleDot]hm, and A. Denner, \
Comput. Phys. Commun., 64, 345-359, 1991.\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.783077167454155*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"271d1460-7fd2-4962-b6e7-95ca7b20a823"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "args","shdw",
    "\"Symbol \\!\\(\\*FormBox[\\\"\\\\\\\"args\\\\\\\"\\\", TraditionalForm]\
\\) appears in multiple contexts \\!\\(\\*FormBox[RowBox[{\\\"{\\\", RowBox[{\
\\\"\\\\\\\"FeynArts`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}], TraditionalForm]\\); \
definitions in context \\!\\(\\*FormBox[\\\"\\\\\\\"FeynArts`\\\\\\\"\\\", \
TraditionalForm]\\) may shadow or be shadowed by other definitions.\"",2,1,1,
    17751136661154077253,"Local","FeynArts`args"},
   "MessageTemplate2"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.782814394221917*^9, 3.7828144032366056`*^9}, 
   3.782814754124957*^9, {3.782814791047851*^9, 3.782814805517082*^9}, 
   3.7828148953122263`*^9, 3.7828167352945147`*^9, 3.782912702980946*^9, 
   3.783053115122279*^9, 3.783053261294159*^9, 3.783053443871139*^9, 
   3.783074160659298*^9, 3.783074563070438*^9, 3.783074671327334*^9, 
   3.783075217453454*^9, 3.783075880550934*^9, 3.7830760329588842`*^9, 
   3.783076196058263*^9, 3.783076293161428*^9, 3.783076462379169*^9, 
   3.783077167614459*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"ac5679d9-8b97-4110-90d7-8db89fb51226"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynArts \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"3.9 patched for use with FeynCalc, for documentation use \
the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["manual",
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or visit \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"www", ".", "feynarts", ".", "de", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feynarts.de/"], None},
       ButtonNote->"www.feynarts.de/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynArts ", "Text", Bold], 
    Style[
    "3.9 patched for use with FeynCalc, for documentation use the ", "Text"], 
    
    Style[
     DisplayForm[
      ButtonBox[
      "manual", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]], 
       Evaluator -> Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" or visit ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["www.feynarts.de.", ButtonData :> {
         URL["http://www.feynarts.de/"], None}, BaseStyle -> "Hyperlink", 
       ButtonNote -> "www.feynarts.de/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.783077167623355*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"29c09e10-2d10-4b8a-bc08-efafbcd3ef94"],

Cell[BoxData[
 FormBox["\<\"MeV-DM - Scalar Mediator: version 0.2.1\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.78307716763006*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"0a0cb673-ba6b-459f-88ac-bbd33c2c4153"],

Cell[BoxData[
 FormBox["\<\"by Adam Coogan and Logan A. Morrison\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{{3.782814790951646*^9, 3.7828148039235277`*^9}, 
   3.782814893714692*^9, 3.782816735193866*^9, 3.782912702880143*^9, 
   3.783053114952354*^9, 3.783053261184627*^9, 3.783053442282875*^9, 
   3.7830741605586987`*^9, 3.7830745629124928`*^9, 3.7830746712131844`*^9, 
   3.7830752173529663`*^9, 3.783075880442493*^9, 3.7830760328522453`*^9, 
   3.78307619442638*^9, 3.783076293045158*^9, 3.783076462278104*^9, 
   3.7830771676395893`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"acea875e-e0b1-4f0b-a65b-13b32d5e3ca2"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Gluon","shdw",
    "\"Symbol \\!\\(\\*FormBox[\\\"\\\\\\\"Gluon\\\\\\\"\\\", \
TraditionalForm]\\) appears in multiple contexts \
\\!\\(\\*FormBox[RowBox[{\\\"{\\\", RowBox[{\\\"\\\\\\\"HazmaTools`\\\\\\\"\\\
\", \\\",\\\", \\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}], \
TraditionalForm]\\); definitions in context \
\\!\\(\\*FormBox[\\\"\\\\\\\"HazmaTools`\\\\\\\"\\\", TraditionalForm]\\) may \
shadow or be shadowed by other definitions.\"",2,1,2,17751136661154077253,
    "Local","HazmaTools`Gluon"},
   "MessageTemplate2"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.782814394221917*^9, 3.7828144032366056`*^9}, 
   3.782814754124957*^9, {3.782814791047851*^9, 3.782814805517082*^9}, 
   3.7828148953122263`*^9, 3.7828167352945147`*^9, 3.782912702980946*^9, 
   3.783053115122279*^9, 3.783053261294159*^9, 3.783053443871139*^9, 
   3.783074160659298*^9, 3.783074563070438*^9, 3.783074671327334*^9, 
   3.783075217453454*^9, 3.783075880550934*^9, 3.7830760329588842`*^9, 
   3.783076196058263*^9, 3.783076293161428*^9, 3.783076462379169*^9, 
   3.783077167658607*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"890c3765-7a33-4028-90c1-7832ed75615d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Utilities", "Section",
 CellChangeTimes->{{3.782816850076833*^9, 
  3.782816851106962*^9}},ExpressionUUID->"f76e431a-8369-4c0d-9289-\
b1c4bb67b350"],

Cell["Utilities for converting expressions to python functions", "Text",
 CellChangeTimes->{{3.782814267007531*^9, 3.7828142720151863`*^9}, {
  3.782814315989769*^9, 
  3.782814334757287*^9}},ExpressionUUID->"70596b1e-0c0a-43a2-98ed-\
f5190ec173df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToPyFnString", "[", "expr_", "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pyPrefix", "=", "\"\<def fn():\\n    return \>\""}], ",", 
      RowBox[{"pySubs", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
         RowBox[{"\"\<Log\>\"", "\[Rule]", "\"\<log\>\""}], ",", 
         RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
         RowBox[{"\"\<Q\>\"", "\[Rule]", "\"\<e_cm\>\""}], ",", 
         RowBox[{"\"\<Lam\>\"", "\[Rule]", "\"\<lam\>\""}], ",", 
         RowBox[{"\"\<ArcTan\>\"", "\[Rule]", "\"\<arctan\>\""}], ",", 
         RowBox[{"\"\<alphaEM\>\"", "\[Rule]", "\"\<alpha_em\>\""}], ",", 
         RowBox[{"\"\<widths\>\"", "\[Rule]", "\"\<width_s\>\""}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"pyPrefix", "<>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"expr", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ml", "\[Rule]", "mf"}], ",", 
             RowBox[{"gsll", "\[Rule]", 
              RowBox[{"gsff", " ", 
               FractionBox["mf", "vh"]}]}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"ArcCot", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"ArcTan", "[", 
              RowBox[{"1", "/", "x"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"ArcCoth", "[", "x_", "]"}], "\[RuleDelayed]", 
             RowBox[{"ArcTanh", "[", 
              RowBox[{"1", "/", "x"}], "]"}]}]}], "}"}]}], "//", 
         "FortranForm"}], "//", "ToString"}], "//", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{"#", ",", "pySubs"}], "]"}], "&"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SavePyFn", "[", 
   RowBox[{"expr_", ",", "fn_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"saveDir", "=", "\"\<~/Desktop/hazma_checks/scalar/\>\""}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"saveDir", "<>", "fn"}], ",", 
      RowBox[{"ToPyFnString", "[", 
       RowBox[{"expr", "//", "FullSimplify"}], "]"}], ",", 
      RowBox[{"\"\<TextDelimiters\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7820249092825117`*^9, 3.782024911309456*^9}, {
   3.782024991952598*^9, 3.782025024240037*^9}, {3.782025134899541*^9, 
   3.7820251602430058`*^9}, {3.782025226479186*^9, 3.782025235020111*^9}, {
   3.782025441602931*^9, 3.7820254451210938`*^9}, 3.7820255712015743`*^9, {
   3.7820260011279507`*^9, 3.782026002821299*^9}, {3.782026528298517*^9, 
   3.782026536657049*^9}, {3.7820268131087933`*^9, 3.782026837826509*^9}, {
   3.782042502589013*^9, 3.782042513851351*^9}, 3.782042898581191*^9, {
   3.782045414326213*^9, 3.7820454148564253`*^9}, 3.782045910289171*^9, {
   3.78214049841963*^9, 3.782140518225312*^9}, {3.782140816446341*^9, 
   3.782140824590302*^9}, {3.782814219507018*^9, 3.782814246142385*^9}, {
   3.7828142771290083`*^9, 3.782814313376066*^9}, {3.7828143667662077`*^9, 
   3.7828143893881893`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"84ea12f1-077a-41f0-9160-5ed51a9dd58d"],

Cell["AP approximations for spectra. See arXiv:hep-ph/0507194.", "Text",
 CellChangeTimes->{{3.782815671542453*^9, 3.7828156800365667`*^9}, {
  3.782815995900202*^9, 
  3.782816000132031*^9}},ExpressionUUID->"1412702b-8dd6-43ff-8fb7-\
26e2cd9f5c31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dndxAPFermion", "=", 
   RowBox[{
    FractionBox["alphaEM", "\[Pi]"], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "2"]}], "x"], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{"1", "-", "x"}], 
        SuperscriptBox["\[Mu]l", "2"]], "]"}], "-", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dndxAPScalar", "=", 
   RowBox[{
    FractionBox["alphaEM", "\[Pi]"], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"1", "-", "x"}], "x"], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{"1", "-", "x"}], 
        SuperscriptBox["\[Mu]l", "2"]], "]"}], "-", "1"}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7828156818607187`*^9, 3.782815707452458*^9}, {
  3.782815974363896*^9, 3.782815984955385*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"833df5bf-c32a-465e-989b-6ea06b43cdd4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Amplitudes", "Section",
 CellChangeTimes->{{3.781998100634973*^9, 
  3.781998102338388*^9}},ExpressionUUID->"2f3a41fe-710b-4377-881b-\
1630844ca0ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
    RowBox[{"l", " ", "+", " ", "lbar"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"amplitudeLL", "=", 
     RowBox[{"HazmaComputeAmplitude", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Lepton", ",", "AntiLepton"}], "}"}], ",", 
       RowBox[{"IncomingMomenta", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"px", ",", "pxbar"}], "}"}]}], ",", 
       RowBox[{"OutgoingMomenta", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"pl", ",", "plbar"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"gamma", " ", "+", " ", "gamma"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amplitudeGG", "=", 
     RowBox[{"HazmaComputeAmplitude", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Photon", ",", "Photon"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi0", " ", "+", " ", "pi0"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amplitude\[Pi]0\[Pi]0", "=", 
     RowBox[{"HazmaComputeAmplitude", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NeutralPion", ",", "NeutralPion"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi", " ", "+", " ", "pi"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"amplitude\[Pi]p\[Pi]m", "=", 
     RowBox[{"HazmaComputeAmplitude", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ChargedPionM", ",", "ChargedPionP"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"S", " ", "+", " ", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"amplitudeSS", "=", 
     RowBox[{"HazmaComputeAmplitude", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ScalarMediator", ",", "ScalarMediator"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.781998111519009*^9, 3.7819981412800503`*^9}, {
  3.781998219640683*^9, 3.7819982364031353`*^9}, {3.7825312424931297`*^9, 
  3.7825313101829443`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"df7a331e-91f7-4805-844a-4ca6c700b210"]
}, Closed]],

Cell[CellGroupData[{

Cell["Squared Amplitudes", "Section",
 CellChangeTimes->{{3.781998248617223*^9, 
  3.781998252614174*^9}},ExpressionUUID->"ffc94a2f-be25-4c9c-87c1-\
b220472c206f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
    RowBox[{"l", " ", "+", " ", "lbar"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"msqrdLL", "=", 
     RowBox[{"HazmaComputeAmplitudeSquared", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Lepton", ",", "AntiLepton"}], "}"}], ",", 
       RowBox[{"IncomingMomenta", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"px", ",", "pxbar"}], "}"}]}], ",", 
       RowBox[{"OutgoingMomenta", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"pl", ",", "plbar"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"gamma", " ", "+", " ", "gamma"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msqrdGG", "=", 
     RowBox[{"HazmaComputeAmplitudeSquared", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Photon", ",", "Photon"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi0", " ", "+", " ", "pi0"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msqrd\[Pi]0\[Pi]0", "=", 
     RowBox[{"HazmaComputeAmplitudeSquared", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NeutralPion", ",", "NeutralPion"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi", " ", "+", " ", "pi"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"msqrd\[Pi]p\[Pi]m", "=", 
     RowBox[{"HazmaComputeAmplitudeSquared", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ChargedPionM", ",", "ChargedPionP"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"S", " ", "+", " ", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"msqrdSS", "=", 
     RowBox[{"HazmaComputeAmplitudeSquared", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ScalarMediator", ",", "ScalarMediator"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.78199825777089*^9, 3.781998278943926*^9}, {
  3.7825313272195177`*^9, 3.7825313696684837`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"9aa83a1e-eafd-4522-9be8-0f6d0ef097c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross Sections", "Section",
 CellChangeTimes->{{3.781920724205839*^9, 
  3.781920731242564*^9}},ExpressionUUID->"b279cb3a-6f34-4ffc-b044-\
56b49faf1216"],

Cell["\<\
To Compute cross sections for 2->2 interactions, use: \
`HazmaComputeCrossSection22[inStates,outStates, ECM]`, where `inStates` and \
`outStates` are arrays of particles states and `ECM` is the variable for the \
center of mass energy.\
\>", "Text",
 CellChangeTimes->{{3.781996739097836*^9, 
  3.781996821165886*^9}},ExpressionUUID->"00b15a62-7fd8-4bea-a7f9-\
10182a526091"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
    RowBox[{"l", " ", "+", " ", "lbar"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"crossSectionLL", "=", 
     RowBox[{"HazmaComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Lepton", ",", "AntiLepton"}], "}"}], ",", "Q"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"gamma", " ", "+", " ", "gamma"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"crossSectionGG", "=", 
     RowBox[{"HazmaComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Photon", ",", "Photon"}], "}"}], ",", "Q"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi0", " ", "+", " ", "pi0"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"crossSection\[Pi]0\[Pi]0", "=", 
     RowBox[{"HazmaComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NeutralPion", ",", "NeutralPion"}], "}"}], ",", "Q"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"pi", " ", "+", " ", "pi"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"crossSection\[Pi]p\[Pi]m", "=", 
     RowBox[{"HazmaComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ChargedPionM", ",", "ChargedPionP"}], "}"}], ",", "Q"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"x", " ", "+", " ", "xbar"}], "\[Rule]", " ", 
     RowBox[{"S", " ", "+", " ", "S"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"crossSectionSS", "=", 
     RowBox[{"HazmaComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"DarkMatter", ",", "AntiDarkMatter"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ScalarMediator", ",", "ScalarMediator"}], "}"}], ",", "Q"}], 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.781996828754382*^9, 3.781996935367835*^9}, {
  3.781996966426385*^9, 3.781997048404323*^9}, {3.782531389489368*^9, 
  3.7825314146757317`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"65900649-a57a-4377-9e07-14f6090ab1b1"]
}, Closed]],

Cell[CellGroupData[{

Cell["FSR Spectra", "Section",
 CellChangeTimes->{{3.781921627256534*^9, 3.781921632441514*^9}, {
  3.78193420868572*^9, 
  3.781934210220111*^9}},ExpressionUUID->"bb7b5918-d76d-47bb-92bb-\
c39553a33642"],

Cell["\<\
NOTE: You do not need to specify the photon in the `outStates`.\
\>", "Text",
 CellChangeTimes->{{3.781998486906681*^9, 
  3.781998510792857*^9}},ExpressionUUID->"032329a1-9a04-4e31-a877-\
5002bcd78d6f"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    OverscriptBox["\[Chi]", "_"], "\[Chi]"}], "\[Rule]", " ", 
   RowBox[{
    OverscriptBox["\[ScriptL]", "_"], "\[ScriptL]\[Gamma]"}]}], 
  TraditionalForm]],
 FormatType->
  "TraditionalForm",ExpressionUUID->"6e36cf1c-925b-4e31-a199-32c8bcbc41d6"]], \
"Subsection",
 CellChangeTimes->{{3.783074734789928*^9, 
  3.7830747559360113`*^9}},ExpressionUUID->"b4a9fe05-b77f-4075-af53-\
b58cb748d2b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dndeLL", "=", 
   RowBox[{"HazmaComputeDNDE", "[", 
    RowBox[{"{", 
     RowBox[{"Lepton", ",", "AntiLepton"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781998367280623*^9, 3.781998383480534*^9}, {
   3.78199842250312*^9, 3.7819984254822483`*^9}, {3.782002037823523*^9, 
   3.782002038309305*^9}, {3.7825314610597763`*^9, 3.78253147207014*^9}, {
   3.783053120053982*^9, 3.783053122731221*^9}, {3.783074758533216*^9, 
   3.783074759260763*^9}, 
   3.783079727737131*^9},ExpressionUUID->"7b582f19-05d7-40e3-9e2b-\
e70b47f7df90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dndxLL", "=", 
   RowBox[{
    RowBox[{
     FractionBox["Q", "2"], 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"dndeLL", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ms", "\[Rule]", "Q"}], ",", 
         RowBox[{"ml", "\[Rule]", 
          RowBox[{"Q", "*", "\[Mu]l"}]}], ",", 
         RowBox[{"E\[Gamma]", "\[Rule]", 
          RowBox[{"Q", "*", 
           RowBox[{"x", "/", "2"}]}]}]}], "}"}]}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Q", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"4", 
             SuperscriptBox["\[Mu]l", "2"]}]}], ">", "x", ">", "0"}]}], 
         "}"}]}]}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"1f273a28-c562-439d-a495-c89c329c1d23"],

Cell["Compare to AP approximation", "Text",
 CellChangeTimes->{{3.782815404015813*^9, 
  3.782815408830042*^9}},ExpressionUUID->"a89b1fe1-84f0-4b4d-99c9-\
24a1ed340b64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"dndxLL", ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]l", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q", ">", "0"}], ",", 
       RowBox[{"1", ">", "x", ">", "0"}], ",", 
       RowBox[{
        FractionBox["1", "2"], ">", "\[Mu]l", ">", "0"}]}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dndxLLLimit", "=", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"%", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Q", ">", "0"}], ",", 
         RowBox[{"1", ">", "x", ">", "0"}], ",", 
         RowBox[{
          FractionBox["1", "2"], ">", "\[Mu]l", ">", "0"}]}], "}"}]}]}], 
     "]"}], "//", "Normal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7820140259768953`*^9, 3.782014026573337*^9}, {
  3.78201414827789*^9, 3.7820141511191587`*^9}, {3.782531552696*^9, 
  3.782531554093375*^9}, {3.782814991377453*^9, 3.78281502055892*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"ad6d2e12-02bb-4a49-a88b-8eb283947a3a"],

Cell[TextData[{
 "Simplified by hand. ",
 StyleBox["TODO: what is going on with the extra term? I \
don\[CloseCurlyQuote]t see why it\[CloseCurlyQuote]s negligible compared to \
the other non-log term.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.7828152411067743`*^9, 3.7828152432491426`*^9}, {
  3.7828154206375637`*^9, 3.7828154218616333`*^9}, {3.782816039546585*^9, 
  3.78281609472998*^9}, {3.78281660665106*^9, 
  3.782816613032124*^9}},ExpressionUUID->"71fd01e3-fd53-405c-9866-\
7e510a4bddd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dndxLLLimit", "=", 
   FractionBox[
    RowBox[{"alphaEM", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox[
            RowBox[{"1", "-", "x"}], 
            SuperscriptBox["\[Mu]l", "2"]], "]"}], "-", "1"}], ")"}]}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "1"}], ")"}], "x"}], "+", "1"}], ")"}]}], 
      ")"}]}], 
    RowBox[{"\[Pi]", " ", "x"}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.782815066186164*^9, 3.782815070225149*^9}, {
  3.782815230612768*^9, 3.782815276131392*^9}, {3.7828155712515173`*^9, 
  3.782815581059321*^9}, {3.7828156114556227`*^9, 
  3.782815629707687*^9}},ExpressionUUID->"5014520e-9e6a-49be-a10f-\
aa89adaf2a4d"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    OverscriptBox["\[Chi]", "_"], "\[Chi]"}], "\[Rule]", " ", 
   RowBox[{
    SuperscriptBox["\[Pi]", "+"], 
    SuperscriptBox["\[Pi]", "-"], "\[Gamma]"}]}], TraditionalForm]],
 FormatType->
  "TraditionalForm",ExpressionUUID->"34c01149-37f3-4c3a-8667-0c5e7ef37cf3"]], \
"Subsection",
 CellChangeTimes->{{3.783074734789928*^9, 
  3.783074770979788*^9}},ExpressionUUID->"6e000a58-544b-47d5-9dab-\
29113fede8c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dnde\[Pi]\[Pi]", "=", 
   RowBox[{"HazmaComputeDNDE", "[", 
    RowBox[{"{", 
     RowBox[{"ChargedPionP", ",", "ChargedPionM"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.781998396287373*^9, 3.781998432765336*^9}, {
   3.781998633803838*^9, 3.781998637188735*^9}, 3.782014167892083*^9, {
   3.782531476949512*^9, 3.7825314862162*^9}, {3.7829126809610453`*^9, 
   3.78291268275823*^9}, {3.783052603917346*^9, 3.783052606050681*^9}, {
   3.78305323647681*^9, 3.783053245651177*^9}, {3.7830532805233994`*^9, 
   3.783053292043622*^9}, {3.783053339740831*^9, 3.7830533400274553`*^9}, {
   3.783074775355919*^9, 
   3.783074775570702*^9}},ExpressionUUID->"fbc9a246-4ad8-4e87-9976-\
ee2003930e8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dndx\[Pi]\[Pi]", "=", 
   RowBox[{
    RowBox[{
     FractionBox["Q", "2"], 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"dnde\[Pi]\[Pi]", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ms", "\[Rule]", "Q"}], ",", 
         RowBox[{"mpi", "\[Rule]", 
          RowBox[{"Q", "*", "\[Mu]\[Pi]"}]}], ",", 
         RowBox[{"E\[Gamma]", "\[Rule]", 
          RowBox[{"Q", "*", 
           RowBox[{"x", "/", "2"}]}]}]}], "}"}]}], "]"}]}], "//", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Q", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"1", "-", 
            RowBox[{"4", 
             SuperscriptBox["\[Mu]\[Pi]", "2"]}]}], ">", "x", ">", "0"}]}], 
         "}"}]}]}], "]"}], "&"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.782531500233408*^9, 3.7825315187971497`*^9}, {
  3.7825315703444223`*^9, 3.7825315744855537`*^9}, {3.782814928125716*^9, 
  3.782814969817498*^9}, {3.782815486775165*^9, 3.78281548733239*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"3a417ef3-dc94-496e-9736-d1c1c18b9973"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{"dndx\[Pi]\[Pi]", ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]\[Pi]", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Q", ">", "0"}], ",", 
       RowBox[{"1", ">", "x", ">", "0"}], ",", 
       RowBox[{
        FractionBox["1", "2"], ">", "\[Mu]\[Pi]", ">", "0"}]}], "}"}]}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dndx\[Pi]\[Pi]Limit", "=", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"%", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Q", ">", "0"}], ",", 
         RowBox[{"1", ">", "x", ">", "0"}], ",", 
         RowBox[{
          FractionBox["1", "2"], ">", "\[Mu]\[Pi]", ">", "0"}]}], "}"}]}]}], 
     "]"}], "//", "Normal"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7820140259768953`*^9, 3.782014026573337*^9}, {
  3.78201414827789*^9, 3.7820141511191587`*^9}, {3.782531552696*^9, 
  3.782531554093375*^9}, {3.782814991377453*^9, 3.78281502055892*^9}, {
  3.782815445487422*^9, 3.782815455509966*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"7f3bd42b-b6d0-42f6-bdbd-62be165891f5"],

Cell[CellGroupData[{

Cell[BoxData["dndx\[Pi]\[Pi]Limit"], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"49c18148-7af5-461a-a4f9-290baa80c9b7"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "alphaEM", " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"2", " ", 
         RowBox[{"log", "(", "\[Mu]\[Pi]", ")"}]}]}], "+", 
       RowBox[{"log", "(", 
        RowBox[{"1", "-", "x"}], ")"}], "-", "1"}], ")"}]}], 
    RowBox[{"\[Pi]", " ", "x"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7829127188127413`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"c2560437-5982-424d-8e86-5bed8e76ed25"]
}, Closed]],

Cell[TextData[{
 "Simplified by hand. ",
 StyleBox["TODO: why is this exactly a factor of two too large?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.78281554536024*^9, 3.782815548592095*^9}, {
  3.782816025539143*^9, 3.7828160326333923`*^9}, {3.782816614727972*^9, 
  3.7828166212238493`*^9}, {3.7828166897818527`*^9, 3.7828166904911423`*^9}, {
  3.782816806996846*^9, 
  3.782816807988872*^9}},ExpressionUUID->"e34b2616-5c47-4260-900c-\
844fa5989dde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dndx\[Pi]\[Pi]Limit", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", "alphaEM"}], "\[Pi]"], 
    RowBox[{"(", 
     FractionBox[
      RowBox[{"1", "-", "x"}], "x"], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{"1", "-", "x"}], 
        SuperscriptBox["\[Mu]\[Pi]", "2"]], "]"}], "-", "1"}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7828155098425837`*^9, 3.782815542000492*^9}, {
  3.782815588913932*^9, 3.782815589912003*^9}, {3.7828159339768667`*^9, 
  3.782815949413254*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"da421123-796e-4b10-8167-5b08227757eb"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["\[Chi]", "_"], "\[Chi]"}], "\[Rule]", " ", 
    RowBox[{
     SuperscriptBox["\[Pi]", "+"], 
     SuperscriptBox["\[Pi]", "-"], "\[Gamma]"}]}], TraditionalForm]],
  ExpressionUUID->"723df025-3c72-4497-8506-940b83533dd2"],
 " with contact diagram removed"
}], "Subsection",
 CellChangeTimes->{{3.7830533128875*^9, 3.783053328801526*^9}, 
   3.783074779542016*^9, 
   3.783076465967698*^9},ExpressionUUID->"c8f1cce6-34ed-43da-8d39-\
baaecedc2f6a"],

Cell[TextData[{
 StyleBox["TODO:",
  FontWeight->"Bold"],
 " get this to run and check that it reduces to the AP expression! If it \
does, then we can conclude the factor of two difference above comes from the \
contact diagram."
}], "Text",
 CellChangeTimes->{{3.783079664086108*^9, 
  3.7830797162485437`*^9}},ExpressionUUID->"051633fe-a813-4a45-8bf9-\
2c79dff80f77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dnde\[Pi]\[Pi]", "=", 
   RowBox[{"HazmaComputeDNDE", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ChargedPionP", ",", "ChargedPionM"}], "}"}], ",", 
     RowBox[{"Adjacencies", "\[Rule]", 
      RowBox[{"{", "3", "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.781998396287373*^9, 3.781998432765336*^9}, {
   3.781998633803838*^9, 3.781998637188735*^9}, 3.782014167892083*^9, {
   3.782531476949512*^9, 3.7825314862162*^9}, {3.7829126809610453`*^9, 
   3.78291268275823*^9}, {3.783052603917346*^9, 3.783052606050681*^9}, {
   3.78305323647681*^9, 3.783053245651177*^9}, {3.7830532805233994`*^9, 
   3.783053292043622*^9}, {3.783053330834239*^9, 3.783053371235289*^9}, {
   3.7830740296901913`*^9, 3.783074034661105*^9}, {3.783074603583358*^9, 
   3.783074628780834*^9}, {3.783074828707369*^9, 3.783074828872984*^9}, {
   3.7830749052945633`*^9, 3.783074906204741*^9}, {3.7830763000262537`*^9, 
   3.7830763002242613`*^9}, {3.783077102063238*^9, 3.783077106077794*^9}, 
   3.7830771567318773`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"474f673b-8229-4e17-833a-32b8420ce214"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Simplify","time",
    "\"Time spent on a transformation exceeded \
\\!\\(\\*FormBox[\\\"300.`\\\", TraditionalForm]\\) seconds, and the \
transformation was aborted. Increasing the value of TimeConstraint option may \
improve the result of simplification.\"",2,3,3,17751136661154077253,"Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.78307809218007*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"80e419a4-1a25-4898-aef3-b9df52c60ef3"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Simplify","time",
    "\"Time spent on a transformation exceeded \
\\!\\(\\*FormBox[\\\"300.`\\\", TraditionalForm]\\) seconds, and the \
transformation was aborted. Increasing the value of TimeConstraint option may \
improve the result of simplification.\"",2,3,4,17751136661154077253,"Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.783078394074607*^9},
 CellLabel->
  "During evaluation of \
In[3]:=",ExpressionUUID->"ff5b9edc-5886-4016-b4e7-8f8c533e26f9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 3, 30, "Input",ExpressionUUID->"3fcc87be-0fb9-46a3-a845-283a91adacdf"],
Cell[CellGroupData[{
Cell[782, 27, 172, 3, 98, "Title",ExpressionUUID->"86471f5c-9740-4661-9e72-77c1a8ac5e9e"],
Cell[957, 32, 228, 5, 35, "Text",ExpressionUUID->"25aa9fe5-b3d3-4d71-9dff-7f7212d567a0"],
Cell[CellGroupData[{
Cell[1210, 41, 844, 13, 52, "Input",ExpressionUUID->"7d60b1b7-c18a-409d-91c6-218296c1be36"],
Cell[CellGroupData[{
Cell[2079, 58, 2839, 73, 30, "Print",ExpressionUUID->"30301dd5-0c5c-4056-bb78-4e1d00b2ca04"],
Cell[4921, 133, 1624, 39, 30, "Print",ExpressionUUID->"8993b10a-9230-4a5e-ae35-1c1d43be25f3"],
Cell[6548, 174, 780, 14, 27, "Print",ExpressionUUID->"fe5a2286-72ee-4d39-9b49-f42b10050213"],
Cell[7331, 190, 765, 14, 27, "Print",ExpressionUUID->"271d1460-7fd2-4962-b6e7-95ca7b20a823"]
}, Open  ]],
Cell[8111, 207, 1227, 22, 24, "Message",ExpressionUUID->"ac5679d9-8b97-4110-90d7-8db89fb51226"],
Cell[CellGroupData[{
Cell[9363, 233, 2398, 63, 30, "Print",ExpressionUUID->"29c09e10-2d10-4b8a-bc08-efafbcd3ef94"],
Cell[11764, 298, 660, 12, 20, "Print",ExpressionUUID->"0a0cb673-ba6b-459f-88ac-bbd33c2c4153"],
Cell[12427, 312, 660, 12, 20, "Print",ExpressionUUID->"acea875e-e0b1-4f0b-a65b-13b32d5e3ca2"]
}, Open  ]],
Cell[13102, 327, 1238, 23, 24, "Message",ExpressionUUID->"890c3765-7a33-4028-90c1-7832ed75615d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14377, 355, 154, 3, 67, "Section",ExpressionUUID->"f76e431a-8369-4c0d-9289-b1c4bb67b350"],
Cell[14534, 360, 249, 4, 35, "Text",ExpressionUUID->"70596b1e-0c0a-43a2-98ed-f5190ec173df"],
Cell[14786, 366, 3476, 75, 395, "Input",ExpressionUUID->"84ea12f1-077a-41f0-9160-5ed51a9dd58d"],
Cell[18265, 443, 249, 4, 35, "Text",ExpressionUUID->"1412702b-8dd6-43ff-8fb7-26e2cd9f5c31"],
Cell[18517, 449, 1065, 34, 98, "Input",ExpressionUUID->"833df5bf-c32a-465e-989b-6ea06b43cdd4"]
}, Closed]],
Cell[CellGroupData[{
Cell[19619, 488, 155, 3, 53, "Section",ExpressionUUID->"2f3a41fe-710b-4377-881b-1630844ca0ce"],
Cell[19777, 493, 3040, 82, 346, "Input",ExpressionUUID->"df7a331e-91f7-4805-844a-4ca6c700b210"]
}, Closed]],
Cell[CellGroupData[{
Cell[22854, 580, 163, 3, 53, "Section",ExpressionUUID->"ffc94a2f-be25-4c9c-87c1-b220472c206f"],
Cell[23020, 585, 3001, 81, 346, "Input",ExpressionUUID->"9aa83a1e-eafd-4522-9be8-0f6d0ef097c7"]
}, Closed]],
Cell[CellGroupData[{
Cell[26058, 671, 159, 3, 53, "Section",ExpressionUUID->"b279cb3a-6f34-4ffc-b044-56b49faf1216"],
Cell[26220, 676, 385, 8, 81, "Text",ExpressionUUID->"00b15a62-7fd8-4bea-a7f9-10182a526091"],
Cell[26608, 686, 2887, 76, 325, "Input",ExpressionUUID->"65900649-a57a-4377-9e07-14f6090ab1b1"]
}, Closed]],
Cell[CellGroupData[{
Cell[29532, 767, 204, 4, 53, "Section",ExpressionUUID->"bb7b5918-d76d-47bb-92bb-c39553a33642"],
Cell[29739, 773, 213, 5, 35, "Text",ExpressionUUID->"032329a1-9a04-4e31-a877-5002bcd78d6f"],
Cell[CellGroupData[{
Cell[29977, 782, 457, 13, 54, "Subsection",ExpressionUUID->"b4a9fe05-b77f-4075-af53-b58cb748d2b1"],
Cell[30437, 797, 578, 12, 30, "Input",ExpressionUUID->"7b582f19-05d7-40e3-9e2b-e70b47f7df90"],
Cell[31018, 811, 946, 28, 47, "Input",ExpressionUUID->"1f273a28-c562-439d-a495-c89c329c1d23"],
Cell[31967, 841, 169, 3, 35, "Text",ExpressionUUID->"a89b1fe1-84f0-4b4d-99c9-24a1ed340b64"],
Cell[32139, 846, 1150, 30, 86, "Input",ExpressionUUID->"ad6d2e12-02bb-4a49-a88b-8eb283947a3a"],
Cell[33292, 878, 513, 11, 35, "Text",ExpressionUUID->"71fd01e3-fd53-405c-9866-7e510a4bddd6"],
Cell[33808, 891, 1021, 30, 63, InheritFromParent,ExpressionUUID->"5014520e-9e6a-49be-a10f-aa89adaf2a4d"]
}, Closed]],
Cell[CellGroupData[{
Cell[34866, 926, 473, 13, 38, "Subsection",ExpressionUUID->"6e000a58-544b-47d5-9dab-29113fede8c8"],
Cell[35342, 941, 743, 15, 30, "Input",ExpressionUUID->"fbc9a246-4ad8-4e87-9976-ee2003930e8f"],
Cell[36088, 958, 1185, 31, 47, "Input",ExpressionUUID->"3a417ef3-dc94-496e-9736-d1c1c18b9973"],
Cell[37276, 991, 1227, 31, 86, "Input",ExpressionUUID->"7f3bd42b-b6d0-42f6-bdbd-62be165891f5"],
Cell[CellGroupData[{
Cell[38528, 1026, 123, 1, 30, "Input",ExpressionUUID->"49c18148-7af5-461a-a4f9-290baa80c9b7"],
Cell[38654, 1029, 576, 16, 51, "Output",ExpressionUUID->"c2560437-5982-424d-8e86-5bed8e76ed25"]
}, Closed]],
Cell[39245, 1048, 466, 10, 35, "Text",ExpressionUUID->"e34b2616-5c47-4260-900c-844fa5989dde"],
Cell[39714, 1060, 673, 19, 51, InheritFromParent,ExpressionUUID->"da421123-796e-4b10-8167-5b08227757eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[40424, 1084, 532, 15, 38, "Subsection",ExpressionUUID->"c8f1cce6-34ed-43da-8d39-baaecedc2f6a"],
Cell[40959, 1101, 369, 9, 35, "Text",ExpressionUUID->"051633fe-a813-4a45-8bf9-2c79dff80f77"],
Cell[CellGroupData[{
Cell[41353, 1114, 1129, 20, 30, "Input",ExpressionUUID->"474f673b-8229-4e17-833a-32b8420ce214"],
Cell[42485, 1136, 544, 12, 24, "Message",ExpressionUUID->"80e419a4-1a25-4898-aef3-b9df52c60ef3"],
Cell[43032, 1150, 545, 12, 24, "Message",ExpressionUUID->"ff5b9edc-5886-4016-b4e7-8f8c533e26f9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

